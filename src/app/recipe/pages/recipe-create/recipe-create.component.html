<div class="max-w-5xl mx-auto p-4 sm:p-8">
  <mat-card class="shadow-xl rounded-xl bg-gradient-to-br from-white to-gray-50 border border-gray-100">
    <mat-card-header class="pb-0">
      <mat-card-title class="text-3xl font-bold text-gray-800 flex items-center gap-2">
        <mat-icon class="text-amber-600">restaurant_menu</mat-icon>
        Crear Nueva Receta
      </mat-card-title>
      <mat-card-subtitle class="text-gray-500">Complete todos los campos requeridos (*)</mat-card-subtitle>
    </mat-card-header>

    <mat-card-content class="p-4 sm:p-6 space-y-8">
      <form [formGroup]="recipeForm" (ngSubmit)="onSubmit()" class="space-y-8">


        <section class="bg-white p-6 rounded-lg shadow-sm border border-gray-100">
          <h3 class="text-xl font-semibold text-gray-800 border-b pb-3 mb-6 flex items-center gap-2">
            <mat-icon class="text-amber-500">info</mat-icon>
            Información Básica
          </h3>

          <div class="space-y-5">
            <mat-form-field appearance="outline" class="w-full">
              <mat-label>Título*</mat-label>
              <input matInput formControlName="title" placeholder="Ej: Ensalada César" />
              <mat-icon matSuffix class="text-gray-400">title</mat-icon>
            </mat-form-field>

            <mat-form-field appearance="outline" class="w-full">
              <mat-label>Descripción</mat-label>
              <textarea matInput formControlName="description" rows="2"
                        placeholder="Breve descripción de la receta"></textarea>
              <mat-icon matSuffix class="text-gray-400">description</mat-icon>
            </mat-form-field>

            <mat-form-field appearance="outline" class="w-full">
              <mat-label>Instrucciones*</mat-label>
              <textarea matInput formControlName="instructions" rows="6"
                        placeholder="Describe paso a paso cómo preparar la receta..."
                        class="font-mono text-sm"></textarea>
              <mat-icon matSuffix class="text-gray-400">format_list_numbered</mat-icon>
            </mat-form-field>
          </div>
        </section>

        <
        <section class="bg-white p-6 rounded-lg shadow-sm border border-gray-100">
          <h3 class="text-xl font-semibold text-gray-800 border-b pb-3 mb-6 flex items-center gap-2">
            <mat-icon class="text-amber-500">monitor_weight</mat-icon>
            Información Nutricional
          </h3>

          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <mat-form-field appearance="outline" class="w-full">
              <mat-label>Calorías (kcal)*</mat-label>
              <input matInput type="number" formControlName="calories" />
              <mat-icon matSuffix class="text-gray-400">local_fire_department</mat-icon>
            </mat-form-field>

            <mat-form-field appearance="outline" class="w-full">
              <mat-label>Carbohidratos (g)*</mat-label>
              <input matInput type="number" formControlName="carbs" />
              <mat-icon matSuffix class="text-gray-400">grain</mat-icon>
            </mat-form-field>

            <mat-form-field appearance="outline" class="w-full">
              <mat-label>Proteínas (g)*</mat-label>
              <input matInput type="number" formControlName="proteins" />
              <mat-icon matSuffix class="text-gray-400">fitness_center</mat-icon>
            </mat-form-field>

            <mat-form-field appearance="outline" class="w-full">
              <mat-label>Grasas (g)*</mat-label>
              <input matInput type="number" formControlName="fats" />
              <mat-icon matSuffix class="text-gray-400">oil_barrel</mat-icon>
            </mat-form-field>
          </div>
        </section>


        <section class="bg-white p-6 rounded-lg shadow-sm border border-gray-100">
          <h3 class="text-xl font-semibold text-gray-800 border-b pb-3 mb-6 flex items-center gap-2">
            <mat-icon class="text-amber-500">kitchen</mat-icon>
            Ingredientes
          </h3>

          <div class="space-y-5">
            <mat-form-field appearance="outline" class="w-full">
              <mat-label>Buscar y agregar ingredientes</mat-label>
              <input
                type="text"
                matInput
                [matAutocomplete]="auto"
                [(ngModel)]="ingredientSearch"
                [ngModelOptions]="{standalone: true}"
                (input)="searchIngredients()"
                placeholder="Escribe para buscar ingredientes..."
              />
              <mat-icon matSuffix class="text-gray-400">search</mat-icon>
            </mat-form-field>

            <mat-autocomplete #auto="matAutocomplete" (optionSelected)="addIngredient($event.option.value)">
              <mat-option *ngFor="let ingredient of filteredIngredients" [value]="ingredient" class="flex items-center">
                <span class="font-medium">{{ ingredient.name }}</span>
                <span class="ml-2 text-xs bg-amber-100 text-amber-800 px-2 py-1 rounded-full">
                  {{ ingredient.calories }} kcal/100g
                </span>
              </mat-option>
            </mat-autocomplete>

            <mat-card *ngIf="selectedIngredients.length" class="bg-gray-50 border border-gray-200 rounded-lg shadow-xs">
              <mat-card-content class="p-4">
                <div class="space-y-3">
                  <div *ngFor="let ingredient of selectedIngredients; let i = index"
                       class="flex justify-between items-center p-3  rounded-lg transition-colors">
                    <div class="flex items-center gap-2">
                      <span class="font-medium text-gray-100  ">{{ ingredient.name }}</span>
                      <span class="text-xs bg-amber-100 text-amber-800 px-2 py-1 rounded-full">
                        {{ ingredient.category }}
                      </span>
                    </div>
                    <div class="flex items-center gap-2">
                      <input
                        type="number"
                        [(ngModel)]="ingredient.quantity"
                        [ngModelOptions]="{standalone: true}"
                        (ngModelChange)="updateNutritionalValues()"
                        class="w-20 px-2 py-1 border bg-gray-300 rounded-md text-sm focus:ring-2 focus:ring-amber-500 focus:border-amber-500"
                        min="1"
                      />
                      <span class="text-sm text-gray-500">g</span>
                      <button mat-icon-button color="warn" (click)="removeIngredient(i)"
                              class="hover:bg-red-100 rounded-full">
                        <mat-icon class="text-red-500">delete</mat-icon>
                      </button>
                    </div>
                  </div>
                </div>
              </mat-card-content>
            </mat-card>
          </div>
        </section>


        <div class="flex flex-col sm:flex-row justify-end gap-3 pt-4">
          <button mat-stroked-button color="warn" type="button" (click)="cancel()"
                  class="border-red-300 text-red-600 hover:bg-red-50 flex items-center gap-1">
            <mat-icon>cancel</mat-icon>
            Cancelar
          </button>
          <button mat-raised-button color="primary" type="submit" [disabled]="!recipeForm.valid"
                  class="bg-gradient-to-r from-amber-500 to-amber-600 hover:from-amber-600 hover:to-amber-700 text-white shadow-md flex items-center gap-1">
            <mat-icon>save</mat-icon>
            Guardar Receta
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>
